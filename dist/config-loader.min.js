var ConfigLoader=function(a,b,c,d){var e={process:function(b){if(b){a.isString(b)&&(b=JSON.parse(b));var c=b.package;c&&c.item&&(b.vmap=d.process(c.item.vmap),delete b.package,delete c.item)}return b}},f=function(b){this.options=b||{},a.defaults(b,{feed:!0,mediaGen:!1}),this.initialize.apply(this,arguments)},g="http://pjs-services-dev-cmtnxgpqy5.elasticbeanstalk.com/config/{{uri}}/?feed={{feed}}&mediaGen={{mediaGen}}",h=f.Events={READY:"ready",ERROR:"error"};return f.prototype={initialize:function(){a.bindAll(this,"onConfigLoaded","onMediaGenLoaded","onError")},load:function(){var c=a.template(this.options.configURL||g,this.options,{interpolate:/\{\{(.+?)\}\}/g});c=Url.setParameters(c,this.options.configParams),this.request=b.getJSON(c,this.onConfigLoaded),this.request.onerror=this.onError},onConfigLoaded:function(a){this.config=a;var c=a.mediaGen.replace(/&amp;/gi,"&");c=Url.setParameters(c,this.options.mediaGenParams),this.request=b.getJSON(c,this.onMediaGenLoaded),this.request.onerror=this.onError},onMediaGenLoaded:function(a){this.config.mediaGen=e.process(a),this.trigger(h.READY,{type:h.READY,data:this.config,target:this})},onError:function(a){this.trigger(h.ERROR,{type:h.ERROR,data:a,target:this})},destroy:function(){this.request&&this.request.abort()}},a.extend(f.prototype,c.Events),f}(_,$,Backbone,VMAPParser);