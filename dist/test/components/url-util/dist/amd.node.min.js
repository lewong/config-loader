!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd&&define(null,b)}(this,function(){function a(a,b){a&&this._parse(a),b&&this.getQueryString().parse(b)}function b(a){this._params={},a&&this.parse(a)}a.version="0.1.0",a.build="Mon Feb 24 2014 11:57:12";for(var c="abcdefghijklmnopqrstuvwxyz0123456789+-.",d={},e=0;e<c.length;e++)d[c.charAt(e)]=!0;return a.parse=function(b,c){return new a(b,c)},a.setParameters=function(b,c){if(c){b=a.parse(b);for(var d in c)c.hasOwnProperty(d)&&b.setParameter(d,c[d])}return b.toString()},a.isValidProtocol=function(a){for(var b=0;b<a.length;b++)if(!d[a.charAt(b)])return!1;return!0},a.prototype={_parse:function(c){var d;if(d=c.indexOf("#"),-1!==d&&(d+1<c.length&&(this.hash=c.substring(d+1)),c=c.substring(0,d)),d=c.indexOf(":"),-1!==d){var e=c.substring(0,d).toLowerCase();if(a.isValidProtocol(e)){if(this.protocol=e,d++,d===c.length)return;c=c.substring(d)}}if("/"===c.charAt(0)&&"/"===c.charAt(1)){if(d=c.indexOf("/",2),-1===d)return void(c.length>2&&this._parseNetworkLocation(c.substring(2)));this._parseNetworkLocation(c.substring(2,d)),c=c.substring(d)}var f=this.protocol;f&&"http"!==f&&"https"!==f?this.path=c:(d=c.indexOf("?"),-1===d?this.path=c:(this.path=c.substring(0,d),d+1<c.length&&(this.queryString=new b(c.substring(d+1)))))},_parseNetworkLocation:function(a){var b=a.indexOf(":");-1===b?this.host=a:(this.host=a.substring(0,b),b<a.length-1&&(this.port=a.substring(b+1)))},setPath:function(a){this.path=a},getPath:function(){return this.path},getQueryString:function(){return this.queryString||(this.queryString=new b),this.queryString},setQueryString:function(a){this.queryString=a},toString:function(){var a=this.queryString?this.queryString.toString():null,b=[];return this.protocol&&(b.push(this.protocol),b.push("://")),void 0!==this.host&&b.push(this.host),void 0!==this.port&&(b.push(":"),b.push(this.port)),b.push(this.path),a&&(b.push("?"),b.push(a)),this.hash&&(b.push("#"),b.push(this.hash)),b.join("")},removeParameter:function(a){this.getQueryString().remove(a)},setParameter:function(a,b){this.getQueryString().set(a,b)},getParameter:function(a){return this.getQueryString().get(a)},getPathWithQueryString:function(){return this.queryString?this.path+"?"+this.queryString:this.path},getPort:function(){return void 0!==this.port?this.port:"http"===this.protocol?80:"https"===this.protocol?443:void 0}},b.parse=function(a){return a?a.constructor===b?a:new b(a.toString()):new b},b.prototype={getParameters:function(){return this._params},parse:function(a){if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&this.add(b,a[b]);else for(var c=a.split("&"),d=0;d<c.length;d++){var e,f,g=c[d],h=g.indexOf("=");-1===h?(e=g,f=null):(e=g.substring(0,h),f=decodeURIComponent(g.substring(h+1))),""!==e&&this.add(e,f)}},remove:function(a){delete this._params[a]},set:function(a,b){null===b?this.remove(a):this._params[a]=b},add:function(a,b){var c=this._params[a];if(void 0!==c)if(c.constructor===Array){if(b.constructor===Array)for(var d=0;d<b.length;d++)c.push(b[d]);else c.push(b);b=c}else b=[c,b];this._params[a]=b},get:function(a){var b=this._params[a];return void 0===b?null:b},getValues:function(a){var b=this._params[a];return void 0===b?null:b.constructor===Array?b:[b]},toString:function(){var a=[];for(var b in this._params)if(this._params.hasOwnProperty(b)){var c=this._params[b];if(void 0===c||null===c)a.push(b);else if(c.constructor===Array)for(var d=0;d<c.length;d++)a.push(b+"="+encodeURIComponent(c[d]));else a.push(b+"="+encodeURIComponent(c))}return a.join("&")}},a});