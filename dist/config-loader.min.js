var ConfigLoader=function(a,b,c){var d={process:function(b){if(b){a.isString(b)&&(b=JSON.parse(b));var d=b.package;d&&d.item&&(b.vmap=c.process(d.item.vmap),delete b.package,delete d.item)}return b}},e=function(b){this.options=b||{},a.defaults(b,{feed:!0,mediaGen:!1}),this.initialize.apply(this,arguments)},f="http://localhost:3000/config/{{uri}}/?feed={{feed}}&mediaGen={{mediaGen}}",g=e.Events={READY:"ready",ERROR:"error"};return e.prototype={initialize:function(){a.bindAll(this,"onConfigLoaded","onMediaGenLoaded","onError")},load:function(){var c=a.template(this.options.configURL||f,this.options,{interpolate:/\{\{(.+?)\}\}/g});b.ajax({url:c,dataType:"json",error:this.onError,success:this.onConfigLoaded})},onConfigLoaded:function(a){this.config=a;var c=a.mediaGen.replace(/&amp;/gi,"&");b.ajax({url:c,dataType:"json",error:this.onError,success:this.onMediaGenLoaded})},onMediaGenLoaded:function(a){this.config.mediaGen=d.process(a),this.trigger(g.READY,{type:g.READY,data:this.config,target:this})},onError:function(a){this.trigger(g.ERROR,{type:g.ERROR,data:a,target:this})}},a.extend(e.prototype,Backbone.Events),e}(_,$,VMAPParser);