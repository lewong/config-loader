var ConfigLoader=function(a,b,c){var d=function(a,b,c){var d=this.request=new XMLHttpRequest;d.open("GET",a,!0),d.setRequestHeader("Accept","application/json"),d.onload=function(){if(d.status>=200&&d.status<400){var a,e;try{a=JSON.parse(d.responseText)}catch(f){e=f}a?b(a):c(e)}else c(d.status)},d.onerror=function(){c(d.status)},d.send()};d.prototype={abort:function(){this.request.abort()}};var e={convert:function(a,b){return b={},a.on=function(c,d){return(b[c]=b[c]||[]).push(d),a},a.once=function(b,c){function d(){c.apply(a.off(b,d),arguments)}return d.h=c,a.on(b,d)},a.off=function(c,d){for(var e=b[c],f=0;d&&e&&e[f];f++)e[f]!==d&&e[f].h!==d||e.splice(f--,1);return f||delete b[c],a},a.emit=function(c){for(var d=b[c],e=0;d&&d[e];)d[e++].apply(a,d.slice.call(arguments,1));return a},a}},f={MEDIA_GEN_ERROR:"mediaGenError",getItem:function(a){return a&&a.item?a.item:a.video.item},process:function(c){a.isString(c)&&(c=JSON.parse(c));var d,e=this.getItem(c.package);return a.isArray(e)?(d=a.find(e,function(b){return a.isObject(b.vmap)}),d&&(d.overlay=a.find(e,function(a){return"overlay"===a.placement}))):a.isObject(e)&&e.vmap&&(d=e),d||a.some(e,function(a){if("text"===a.type)throw{name:f.MEDIA_GEN_ERROR,message:a.text}}),d.vmap=b.process(d.vmap),d}},g={whitelist:["feed","mediaGen","uri","geo","ref","type","group","device","network","chromeless","autoPlay","adFreeInterval","ccEnabled","useSegmentedScrubber","useNativeControls"],process:function(b,c){return b&&(b.adFreeInterval=b.timeSinceLastAd,a.isUndefined(b.adFreeInterval)&&(b.adFreeInterval=b.freewheelMinTimeBtwAds),b=a.pick(b,this.whitelist.concat(c.whitelist||[]))),b}},h=function(b){this.options=b||{},a.defaults(b,{feed:!0,mediaGen:!1,configParams:a.defaults(b.configParams||{},{returntype:"config",configtype:"vmap",uri:b.uri}),mediaGenParams:b.mediaGenParams||{}}),b.verboseErrorMessaging&&(this.getErrorMessage=a.identity),this.initialize.apply(this,arguments)},i=function(b,c){return b=b.replace(/\{{1,}/g,"{{").replace(/\}{1,}/g,"}}"),a.template(b,c,{interpolate:/\{\{(.+?)\}\}/g})},j="http://media.mtvnservices.com/pmt/e1/access/index.html",k=h.Events={READY:"ready",ERROR:"error"};return h.DEFAULT_ERROR_MESSAGE="Sorry, this video is currently not available.",h.prototype={initialize:function(){a.bindAll(this,"onConfigLoaded","onMediaGenLoaded","onError","onLoadError"),e.convert(this)},load:function(){var a=i(this.options.configURL||j,this.options,{});a=c.setParameters(a,this.options.configParams),this.request=new d(a,this.onConfigLoaded,this.onLoadError)},onConfigLoaded:function(b){if(b.config&&(b=b.config),b.error)return void this.onError(this.getErrorMessage(b.error));this.config=g.process(b,this.options);var e=this.options.mediaGenURL||b[this.options.mediaGenProperty||"mediaGen"];if(e){var f=a.clone(this.options.mediaGenParams);a.each(b.overrideParams,function(a,b){f["UMBEPARAM"+b]=a}),e=c.setParameters(i(e,b),f),this.request=new d(e,this.onMediaGenLoaded,this.onLoadError)}else this.onError(this.getErrorMessage("no media gen specified."))},onMediaGenLoaded:function(a){var b;try{a=f.process(a)}catch(c){b=!0,this.onError(c.name===f.MEDIA_GEN_ERROR?c.message:this.getErrorMessage(c))}b||(this.config.mediaGen=a,this.emit(k.READY,{type:k.READY,data:this.config,target:this}))},onLoadError:function(a){this.onError(this.getErrorMessage(a))},onError:function(a){this.emit(k.ERROR,{type:k.ERROR,data:a,target:this})},getErrorMessage:function(){return h.DEFAULT_ERROR_MESSAGE},destroy:function(){this.request&&this.request.abort()}},h.version="0.5.0",h.build="Tue Apr 22 2014 17:23:35",h}(_,VMAPParser,Url);